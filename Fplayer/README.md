# Fplayer - Terraria 假人插件

一个功能强大的Terraria假人插件，支持创建和控制虚拟玩家。

## 功能特性

### 基础功能
- ✅ 创建和移除假人
- ✅ 假人列表查看
- ✅ 重新连接假人
- ✅ 基础移动控制
- ✅ 聊天功能
- ✅ 物品使用
- ✅ 位置传送

### 移动系统
- ✅ 持续移动（左/右）
- ✅ 跳跃功能
- ✅ 传送假人到玩家位置
- ✅ **滑轮系统** - 支持在绳子上移动
- ✅ **便携式凳子** - 支持凳子状态控制
- ✅ **水平移动系统** - 基于Terraria原版的跑步、加速、减速机制
- ✅ **装备系统** - 支持各种移动装备的效果

### 物理系统
- ✅ **重力系统** - 支持不同环境下的重力效果（普通、水中、蜂蜜中）
- ✅ **地面检测** - 基于Terraria原版FloorVisuals逻辑的精确地面检测
- ✅ **碰撞检测** - 基于Terraria原版逻辑的地面碰撞、墙壁碰撞、自动上坡
- ✅ **跳跃系统** - 基于Terraria原版逻辑的跳跃机制，正确的地面状态检测
- ✅ **滑轮系统** - 支持在绳子上滑行，包括便携式凳子
- ✅ **水平移动系统** - 基于原版的移动速度和加速度
- ✅ **重力碰撞系统** - 完整的环境适应和碰撞检测
- ✅ **墙壁碰撞** - 防止假人穿过墙壁的完整碰撞检测

### 重力碰撞系统 (v2.4.0)
- ✅ **重力系统** - 支持水、蜂蜜、翅膀等环境重力影响
- ✅ **碰撞系统** - 干燥、水中、蜂蜜环境的不同碰撞处理
- ✅ **特殊移动** - 墙壁滑行、地毯飞行等特殊移动方式
- ✅ **环境检测** - 自动检测当前环境并调整物理参数
- ✅ **装备影响** - 翅膀、钉子靴子、地毯等装备效果

## 命令列表

### 基础命令
- `/dummy create [name]` - 创建假人
- `/dummy remove [name]` - 移除假人
- `/dummy list` - 查看假人列表
- `/dummy reconnect [name]` - 重新连接假人

### 移动命令
- `/dummy startmove [name] [left|right]` - 开始持续移动
- `/dummy stopmove [name]` - 停止移动
- `/dummy jump [name]` - 跳跃
- `/dummy tp [name] [player]` - 传送假人到玩家位置

### 滑轮系统命令
- `/dummy stool [name] [on|off]` - 设置便携式凳子状态

### 水平移动系统命令
- `/dummy movement [name]` - 查看移动状态
- `/dummy equipment [name] [type] [on|off]` - 设置装备状态

### 移动和物理系统
- `/dummy jump <假人名称>` - 让假人跳跃
- `/dummy movement <假人名称>` - 查看移动状态
- `/dummy equipment <假人名称> <装备类型> <on|off>` - 设置装备状态
- `/dummy gravity <假人名称>` - 查看重力状态
- `/dummy collision <假人名称>` - 查看碰撞状态
- `/dummy special <假人名称>` - 查看特殊移动状态

## 滑轮系统

滑轮系统允许假人在绳子上移动，包括以下特性：

### 功能特性
- **自动检测绳子** - 假人会自动检测附近的绳子
- **多位置支持** - 支持左、中、右三个位置
- **便携式凳子** - 可以通过命令控制凳子状态
- **平滑移动** - 在绳子上移动时速度适中

### 使用方法
1. 在绳子上使用 `/dummy stool [name] on` 启用便携式凳子
2. 使用移动命令让假人在绳子上移动
3. 使用 `/dummy stool [name] off` 禁用凳子状态

### 技术实现
- 基于Terraria原版的FindPulley方法
- 支持绳子连接检测
- 自动选择最近的绳子位置
- 碰撞检测确保安全移动

## 水平移动系统

水平移动系统基于Terraria原版的HorizontalMovement方法，提供了完整的跑步、加速、减速等机制。

### 功能特性
- **平滑加速** - 假人逐渐加速到最大速度
- **自然减速** - 停止移动时自然减速
- **速度限制** - 不会超过最大速度
- **朝向更新** - 移动方向正确更新
- **装备支持** - 支持各种移动装备的效果

### 装备系统
支持以下装备类型：
- **赫尔墨斯靴子** - 增加1点最大速度
- **幽灵靴子** - 增加1点最大速度
- **闪电靴子** - 增加2点最大速度和0.1加速
- **霜花靴子** - 增加2.5点最大速度和0.15加速
- **大地火花靴子** - 增加3点最大速度和0.2加速
- **翅膀** - 增加0.5点最大速度
- **火箭靴** - 增加0.3点最大速度
- **喷气背包** - 增加0.8点最大速度

### 使用方法
1. 使用 `/dummy equipment [name] [type] [on|off]` 设置装备
2. 使用 `/dummy movement [name]` 查看移动状态
3. 使用移动命令让假人移动

### 技术实现
- 基于Terraria原版的HorizontalMovement方法
- 支持装备效果叠加
- 支持状态影响（如冰冻）
- 实时参数更新

## 安装说明

1. 下载最新版本的插件
2. 将DLL文件放入TShock的ServerPlugins文件夹
3. 重启服务器
4. 使用命令创建和管理假人

## 版本历史

### v2.6.0 (当前版本)
- ✅ 基于Terraria原版物理逻辑的全面改进
- ✅ 改进地面检测逻辑，防止陷入土里
- ✅ 添加完整的墙壁碰撞检测，防止穿墙
- ✅ 修复跳跃状态管理，解决空中状态问题
- ✅ 优化碰撞检测算法，提高性能和准确性

### v2.5.0
- ✅ 集成Terraria原版水平移动逻辑
- ✅ 添加装备系统支持
- ✅ 改进移动加速和减速机制
- ✅ 添加移动状态查看功能

### v2.4.0
- ✅ 集成Terraria原版跳跃逻辑
- ✅ 添加滑轮系统支持
- ✅ 改进地面检测和碰撞系统
- ✅ 添加便携式凳子功能

### v2.3.0
- ✅ 基础假人创建和管理
- ✅ 移动和跳跃功能
- ✅ 传送功能

## 技术细节

### 物理系统改进 (v2.6.0)
基于Terraria原版物理逻辑的全面改进：

#### 地面检测改进
- **精确检测**：基于Terraria原版FloorVisuals逻辑
- **多点检测**：检查玩家宽度范围内的所有方块
- **防止陷入**：改进的碰撞检测逻辑，确保玩家不会穿过地面

#### 墙壁碰撞检测
- **完整碰撞**：检查玩家碰撞箱的所有边界
- **方向检测**：分别检测水平和垂直移动的碰撞
- **防止穿墙**：阻止假人穿过墙壁

#### 跳跃状态管理
- **正确重置**：只有在地面上时才能跳跃
- **状态同步**：跳跃状态与地面状态正确同步
- **防止卡跳**：避免一直显示空中状态的问题

### 物理参数
- 重力加速度：0.4f
- 跳跃持续时间：0.4秒
- 移动速度：3.0f
- 最大下落速度：10f

### 滑轮系统
- 移动速度：2.5f
- 支持三个位置（左、中、右）
- 自动碰撞检测

### 水平移动系统
- 基础最大速度：6f
- 基础加速：0.4f
- 基础减速：0.4f
- 支持装备叠加效果
- 支持状态影响

## 许可证

MIT License - 详见LICENSE文件 